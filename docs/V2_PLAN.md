# V2実装計画（ドラフト）

## 0. 目的
V1で整えた体験を土台に、V2では「聖杯戦争らしい中期戦」と「判断しやすいUI演出」を実装し、再プレイ性を高める。

- 対象スコープ: 戦闘コア刷新、判断UI改善、演出強化、コンテンツ拡張
- 期間目安: Sprint 6〜8
- 優先順位: まずロジック、次に演出・素材差し替え

---

## 1. 方針（確定）

- 戦闘ターンは **2ターン以上、最大99ターン**。
- 想定プレイ感は通常戦で **3〜4ターン決着**。
- 撤退は通常戦で許可、**ボス戦は撤退不可ルール**を適用。
- まずはロジック優先で実装し、立ち絵・音はフリー素材で先行接続。
- 新規サーヴァントは段階的に追加（目標7体）。
- クラス差分宝具はまず3騎で検証し、安定後に全騎へ展開。

---

## 2. Sprint 6（V2-Phase A: 戦闘コア刷新）

### 目標
1ターン戦闘から、複数ターン前提の戦術ループへ移行する。

### Must
1. マルチターン戦闘ループ実装（2〜99ターン）
2. 行動フェーズ再設計（攻撃 / スキル / 宝具 / 防御 / 撤退）
3. 撤退判定のルール化（通常戦のみ撤退可）
4. ボス戦フラグ時は撤退不可
5. 回帰スクリプト整備（既存4エンド非破壊）

### 受け入れ条件（Done）
- 通常戦は3〜4ターン中心で決着する。
- ボス戦では撤退コマンドが表示されない、または選択しても無効化される。
- 既存回帰（D-3相当）が通る。

---

## 3. Sprint 7（V2-Phase B: 判断UI + 演出）

### 目標
プレイヤーが「今押すべき選択肢」を短時間で判断できるUIにする。

### Must
1. スキル / 宝具コマンドへ魔力消費量を明記
2. 対面クラスごとの重要比較ステータスを強調
3. 宝具演出（真名解放・詠唱）
4. 令呪演出（専用テキスト）
5. 召喚詠唱演出（複数バリエーション + 抽選補正接続）

### Should
- ダメージ要約ログを本文シーンへ自然に差し込む。

### 受け入れ条件（Done）
- UI単体で判断材料が揃っている。
- 召喚 / 令呪 / 宝具に演出差があり、役割が見て分かる。

---

## 4. Sprint 8（V2-Phase C: コンテンツ拡張）

### 目標
設定準拠の差分を増やし、周回時に異なる展開を体験できるようにする。

### Must
1. クラス差分宝具を3騎先行実装（検証対象）
2. 新規サーヴァント追加（目標7体、段階導入）
3. 日中イベントの本格ライティング拡張
4. 会話表示の話者色分離（判読性改善）

### Should
- フリー素材立ち絵（マスター / サーヴァント / 令呪）
- フリー素材SE / BGM導入

### 受け入れ条件（Done）
- 3騎のクラス差分宝具が戦闘で正しく動作する。
- 追加サーヴァントが召喚 → 戦闘 → 本文まで接続される。
- 話者判別性が改善される。

---

## 5. V3への接続（先行メモ）

V2では最終日大型刷新を無理に詰め込まず、V3で以下を主目標に切り出す。

- 最終日総力戦の多段フェーズ化
- 専用ギミック（敗北学習導線を含む）
- クライマックス演出の専用化

---

## 6. 依存関係・リスク

### 依存
- 既存CSVデータ構造（戦闘 / サーヴァント定義）
- 回帰スクリプトの更新
- 文章量増加に合わせたシーン命名・管理

### リスク
- 99ターン上限に対するバランス調整工数
- 演出追加に伴うテンポ悪化（ログ量の過多）
- サーヴァント追加時の相性差分管理コスト

### 緩和策
- 先に3騎で差分宝具を検証し、実装テンプレート化
- ダメージログは要約優先で冗長行を削減
- スプリント末に必ず回帰を固定実行

---

## 7. 未確定事項（PO確認待ち）

1. 新規7体の追加順序
   - 候補: 三騎士（セイバー / アーチャー / ランサー）先行
2. 話者色分離の最終ルール
   - 候補: 主人公 / 自サーヴァント / 敵サーヴァント / 地の文 の4色固定

上記2点は決定後に本ドキュメントへ反映し、V2を「確定版」に更新する。

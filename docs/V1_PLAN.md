# 聖杯戦争ADV RPG V1計画（Phase 2）

## 1. V1で作るもの（決定事項の反映）
- 体験の核は **「自分の選択で運命が変わる感覚」**。
- プレイ時間は **30〜60分**、短くても濃い1周完結型。
- ゲーム形式は **分岐ノベル + 簡易バトル（ステータス判定）**。
- ルールは以下をV1必須として実装する。
  1. 真名秘匿
  2. 技/宝具の使用
  3. サーヴァントスキル + パラメーターによる判定
- キャラクターは **既存/オリジナル混在**。既存キャラの別クラス召喚も許可。
- 敗北条件あり：**マスター死亡でゲームオーバー**。
- サーヴァント死亡時は、シナリオ条件次第で **再契約/再召喚の可能性** を残す。
- ビジュアル方針は **UI/演出重視**（背景素材は最小構成）。
- 公開先は **GitHub Pages**。音はV1では未実装。

## 2. V1機能スコープ

### 必須（Must）
1. 日本語UIとテキスト表示（固有用語は日本語表記）
2. 会話・地の文の分岐システム
3. フラグ管理（選択結果、真名暴露状態、信頼度など）
4. 簡易バトル判定（ランダム + ステータス補正）
5. 宝具/スキルのクールダウンまたは使用制限
6. マスター死亡ゲームオーバー分岐
7. エンディング2種以上（勝利/敗北）

### 可能なら（Should）
1. サーヴァント再召喚イベント（条件付き1回）
2. 戦闘ログの履歴表示
3. 既読スキップ

### 後回し（V2）
1. BGM/SE
2. セーブ/ロード
3. 複数ルート長編化
4. マップ探索

## 3. 技術アプローチ（平易版）
- 技術は **HTML/CSS/JavaScriptのみ** で開始し、GitHub Pagesでそのまま配信可能にする。
- ストーリーはJSON（またはJSオブジェクト）で管理し、1つの「シーン再生エンジン」で進行。
- 戦闘は「基礎値 + スキル補正 + 乱数」で判定して、結果に応じて次シーンへ分岐。
- 画面は1ページ構成（SPA風）で、以下の領域を固定化。
  - テキストウィンドウ
  - 選択肢
  - ステータスパネル（マスター/サーヴァント）
  - ログパネル

## 4. 画面の完成イメージ（ラフ）
1. タイトル
2. 導入（契約・陣営確定）
3. 日常フェーズ（情報収集/行動選択）
4. 夜戦フェーズ（接敵/判定/宝具）
5. クライマックス戦
6. 結末表示

## 5. データ設計（最小）
```js
state = {
  day: 1,
  masterHP: 100,
  servantHP: 100,
  servantStats: {筋力: 3, 耐久: 4, 敏捷: 3, 魔力: 5, 幸運: 2, 宝具: 4},
  flags: {
    trueNameExposed: false,
    usedNoblePhantasm: false,
    canResummon: false,
  }
}
```

## 6. 実装ステップ（見える形で進める）
1. **基盤**: 1ページUI骨組み + 日本語フォント/配色
2. **シナリオエンジン**: シーン遷移・選択肢・フラグ処理
3. **戦闘モジュール**: ステータス判定 + 宝具使用
4. **ゲームオーバー/エンディング**: 条件分岐と表示
5. **仕上げ**: 操作感、表示調整、GitHub Pages公開設定

## 7. 工数感
- 難易度: **Medium（中）**
- 理由:
  - ノベル分岐だけなら軽量だが、
  - ルール準拠の戦闘判定・再召喚条件で設計難度が上がるため。

## 8. 次の実装提案（Phase 3開始）
次は以下の最小実装から着手する。
1. `index.html`（画面レイアウト）
2. `styles/main.css`（雰囲気重視のUI）
3. `src/game.js`（状態管理・分岐・判定）
4. `src/scenario.js`（V1用の短編シナリオ）

この構成なら、早い段階で「動く1周」を確認でき、以後の拡張も壊れにくい。
